!function(){"use strict";class t extends Laya.EventDispatcher{}t.main_color="#54B537",t.arr_q_data=new Array,t.arr_finished_data=new Array,t.curr_q_num=0,t.total_q_num=0;var i=Laya.Text;class e extends Laya.Sprite{constructor(){super(),this.block_width=90,this.block_height=30}onEnable(){this.size(this.block_width,this.block_height),this.graphics.drawRect(0,0,this.block_width,this.block_height,t.main_color),this.pivot(0,this.height/2),this.txt_countdown=new i,this.txt_countdown.align="center",this.txt_countdown.fontSize=25,this.txt_countdown.color="#ffffff",this.txt_countdown.text="00:00",this.addChild(this.txt_countdown),this.txt_countdown.pivot(this.txt_countdown.width/2,this.txt_countdown.height/2),this.txt_countdown.pos(this.block_width/2,this.block_height/2)}setTxt(t){this.txt_countdown.text=t}}class s extends Laya.Sprite{constructor(t,i){super(),this.video_path=t,this.coordinate_space=i,this.creatVideo()}creatVideo(){let t=Laya.Browser.createElement("div");t.className="div",Laya.Browser.document.body.appendChild(t),Laya.Utils.fitDOMElementInArea(t,this.coordinate_space,0,0,this.coordinate_space.width-1,this.coordinate_space.height),this.divElement=t;let i=Laya.Browser.createElement("video");i.setAttribute("id","questionvideo"),this.videoElement=i,i.controls=!0,i.autoPlay=!0,i.setAttribute("webkit-playsinline",!0),i.setAttribute("playsinline",!0),i.setAttribute("x5-video-player-type","h5"),i.setAttribute("x-webkit-airplay",!0),i.setAttribute("x5-video-orientation","portrait"),i.setAttribute("preload","auto"),i.setAttribute("width","100%"),i.setAttribute("height","100%"),i.type="vedio/mp4",i.src=this.video_path,i.play(),this.divElement.appendChild(i),this.videoEvent()}videoEvent(){this.videoElement.addEventListener("loadstart",()=>{}),this.videoElement.addEventListener("progress",()=>{}),this.videoElement.addEventListener("play",()=>{}),this.videoElement.addEventListener("pause",()=>{}),this.videoElement.addEventListener("seeking",()=>{}),this.videoElement.addEventListener("seeked",()=>{}),this.videoElement.addEventListener("waiting",()=>{}),this.videoElement.addEventListener("timeupdate",()=>{}),this.videoElement.addEventListener("ended",()=>{this.videoElement.pause(),this.event("VIDEO_ELEMENT_ENDED")}),this.videoElement.addEventListener("error",()=>{})}removeVideo(){this.videoElement.pause(),Laya.Browser.document.body.removeChild(this.divElement)}}var h=Laya.Sprite,a=Laya.Event,r=Laya.Button,n=Laya.SoundManager,_=Laya.Handler;class o extends Laya.Sprite{constructor(t,i,e){let s;switch(super(),this.radian_to_point_dis=10,this.rect_radius=10,this.btn_skin_path="q_comp/button.png",this.musicTime=0,this.media_path=e,this.size(t,i),this.block_width=t-20,this.block_height=i-20,this.rect_path=[["moveTo",this.radian_to_point_dis,0],["lineTo",this.block_width-this.radian_to_point_dis,0],["arcTo",this.block_width,0,this.block_width,this.radian_to_point_dis,this.rect_radius],["lineTo",this.block_width,this.block_height-this.radian_to_point_dis],["arcTo",this.block_width,this.block_height,this.block_width-this.radian_to_point_dis,this.block_height,this.rect_radius],["lineTo",this.radian_to_point_dis,this.block_height],["arcTo",0,this.block_height,0,this.block_height-this.radian_to_point_dis,this.rect_radius],["lineTo",0,this.radian_to_point_dis],["arcTo",0,0,this.radian_to_point_dis,0,this.rect_radius]],this.graphics.drawRect(0,0,this.width,this.height,"#00000088"),this.graphics.drawPath(10,10,this.rect_path,{fillStyle:"#ffffff"},{strokeStyle:"#000000",lineWidth:"1"}),this.media_type=this.media_path.substr(this.media_path.lastIndexOf("."),this.media_path.length),this.media_type){case".mp3":this.sp_play_btn=new h,this.sp_play_btn.flag=!1,this.sp_play_btn.texture_play="q_comp/play_btn/play_btn.png",this.sp_play_btn.texture_stop="q_comp/play_btn/stop_btn.png",s=Laya.loader.getRes(this.sp_play_btn.texture_play),this.sp_play_btn.size(s.width,s.height),this.sp_play_btn.graphics.drawTexture(s),this.sp_play_btn.pos((this.width-this.sp_play_btn.width)/2,(this.height-this.sp_play_btn.height)/2),this.sp_play_btn.on(a.CLICK,this,this.playMp3Handler),this.addChild(this.sp_play_btn),this.btn_back=new r(this.btn_skin_path),this.btn_back.labelSize=20,this.btn_back.label="返回",this.btn_back.pivotX=this.btn_back.width/2,this.btn_back.pos(this.width/2,this.height-3*this.btn_back.height),this.btn_back.labelColors="#FFFFFF",this.addChild(this.btn_back),this.btn_back.on(a.CLICK,this,this.btnBackClickHandler),this.sound_channel=new Laya.SoundChannel;break;case".mp4":this.sp_play_btn=new h,s=Laya.loader.getRes("q_comp/play_btn/video_play_btn.png"),this.sp_play_btn.size(s.width,s.height),this.sp_play_btn.graphics.drawTexture(s),this.sp_play_btn.pos((this.width-this.sp_play_btn.width)/2,(this.height-this.sp_play_btn.height)/2),this.sp_play_btn.on(a.CLICK,this,this.playMp4Handler),this.addChild(this.sp_play_btn)}}playMp4Handler(t){let i,e=this.media_path;i=new s(e,this);let h=function(){i.off("VIDEO_ELEMENT_ENDED",i,h),i.removeVideo(),this.event("QUESTION_READ_COMPLETE"),this.destroy(!0)};i.on("VIDEO_ELEMENT_ENDED",this,h)}playMp3Handler(t){let i=t.currentTarget,e=(i.flag=!i.flag)?i.texture_stop:i.texture_play;i.graphics.clear();let s=Laya.loader.getRes(e);if(i.size(s.width,s.height),i.graphics.drawTexture(s),i.flag){let t=this.media_path;this.sound_channel=n.playMusic(t,1,new _(this,this.soundCompleteHandler),this.musicTime)}else this.musicTime=this.sound_channel.position,n.stopMusic()}soundCompleteHandler(){if(this.sound_channel.duration==this.sound_channel.position){this.musicTime=0;let t=(this.sp_play_btn.flag=!this.sp_play_btn.flag)?this.sp_play_btn.texture_stop:this.sp_play_btn.texture_play;this.sp_play_btn.graphics.clear();let i=Laya.loader.getRes(t);this.sp_play_btn.size(i.width,i.height),this.sp_play_btn.graphics.drawTexture(i)}}btnBackClickHandler(t){switch(this.media_type){case".mp3":n.stopMusic(),this.musicTime=0,this.sp_play_btn.flag=!1,this.sp_play_btn.graphics.clear();let t=Laya.loader.getRes(this.sp_play_btn.texture_play);this.sp_play_btn.size(t.width,t.height),this.sp_play_btn.graphics.drawTexture(t)}this.visible=!1}destroy(t){switch(this.media_type){case".mp3":n.stopMusic(),this.musicTime=0,this.sp_play_btn.flag=!1,this.sp_play_btn.graphics.clear();let t=Laya.loader.getRes(this.sp_play_btn.texture_play);this.sp_play_btn.size(t.width,t.height),this.sp_play_btn.graphics.drawTexture(t)}super.destroy(t)}onEnable(){super.onEnable()}}var d=Laya.Sprite,c=Laya.ProgressBar,l=Laya.Button,g=Laya.Event,p=Laya.Text,u=Laya.Handler;class w extends Laya.Sprite{constructor(t,i){super(),this.a_random=!0,this.rocket_running_gap=0,this.time_takes=0,this.btn_skin_path="q_comp/button.png",this.media_name="",this.size(t,i)}onEnable(){this.txt_info=new p,this.txt_info.align="left",this.txt_info.fontSize=20,this.txt_info.y=this.height-this.txt_info.height,this.addChild(this.txt_info),this.y=Laya.stage.height-this.height,this.q_type_icon=new d,this.q_type_icon.x=10,this.q_type_icon.y=10,this.q_type_icon.graphics.clear();let i=Laya.loader.getRes("q_comp/"+t.arr_q_data[t.curr_q_num]["题目标签"]);this.q_type_icon.size(i.width,i.height),this.q_type_icon.graphics.drawTexture(i),this.addChild(this.q_type_icon),this.container_countdown=new d,this.container_countdown.visible=!1,this.addChild(this.container_countdown),this.countdown_progress_bar=new c("q_comp/progress.png"),this.countdown_progress_bar.width=Laya.stage.width-150,this.countdown_progress_bar.pivotY=this.countdown_progress_bar.height/2,this.countdown_progress_bar.value=0,this.container_countdown.addChild(this.countdown_progress_bar),this.countdown_rocket=new d;var s=Laya.loader.getRes("q_comp/timer_rocket.png");this.countdown_rocket.graphics.drawTexture(s),this.countdown_rocket.size(s.width,s.height),this.countdown_rocket.pivotY=this.countdown_rocket.height/2,this.container_countdown.addChild(this.countdown_rocket),this.rocket_running_gap=(this.countdown_progress_bar.width-this.countdown_rocket.width)/t.arr_q_data[t.curr_q_num]["倒计时间"],this.countdown_block=new e,this.countdown_block.x=this.countdown_progress_bar.x+this.countdown_progress_bar.width+35,this.container_countdown.addChild(this.countdown_block),this.container_countdown.height=this.countdown_block.height,this.startCountDown(),this.btn_next=new l(this.btn_skin_path),this.btn_next.labelSize=26,t.curr_q_num<t.arr_q_data.length-1?this.btn_next.label="下一题":this.btn_next.label="提交",this.btn_next.pivotX=this.btn_next.width/2,this.btn_next.pos(Laya.stage.width/2,Laya.stage.height-5*this.btn_next.height),this.btn_next.labelColors="#FFFFFF",this.btn_next.disabled=!0,this.addChild(this.btn_next),this.btn_next.on(g.CLICK,this,this.btnNextClickHandler);var h=t.arr_q_data[t.curr_q_num]["音频题_视频题_图片题"].split(","),a="";if(""==h[0]||(a=h[0].substr(h[0].lastIndexOf("."),h[0].length)),".mp3"==a||".mp4"==a||".png"==a)if(this.media_name=h[0],this.reading_panel=new o(this.width,this.height,"q_comp/questions/"+(t.curr_q_num+1)+"/"+this.media_name),this.reading_panel.visible=!1,this.addChild(this.reading_panel),h.length<2){this.sp_btn_read=new d,this.sp_btn_read.graphics.clear();let t=Laya.loader.getRes("q_comp/读题btn.png");this.sp_btn_read.graphics.drawTexture(t),this.sp_btn_read.size(t.width,t.height),this.sp_btn_read.x=Laya.stage.width-this.sp_btn_read.width-10,this.sp_btn_read.y=this.q_type_icon.y,this.addChild(this.sp_btn_read),this.sp_btn_read.on(g.CLICK,this,this.readBtnClickHandler)}else this.reading_panel.visible=!0;this.arr_assets=new Array;for(var r=t.arr_q_data[t.curr_q_num]["资源图片名称"].split(","),n=0;n<r.length;n++)this.arr_assets.push({url:"q_comp/questions/"+(t.curr_q_num+1)+"/"+r[n],type:Laya.Loader.IMAGE});t.arr_q_data[t.curr_q_num]["题目主图"]&&this.arr_assets.push({url:"q_comp/questions/"+(t.curr_q_num+1)+"/"+t.arr_q_data[t.curr_q_num]["题目主图"],type:Laya.Loader.IMAGE}),Laya.loader.retryNum=3,Laya.loader.load(this.arr_assets,u.create(this,this.onAssetLoaded)),Laya.loader.on(g.ERROR,this,this.onAssetLoadError)}btnNextClickHandler(){this.event("NEXT_BTN_CLICK",this.btn_next.label)}onAssetLoaded(){}onAssetLoadError(t){}drawBgColor(){this.graphics.drawRect(0,0,this.width,this.height,"#E7F2BC")}startCountDown(){this.countdown_block.setTxt(this.GetTimeLeft2BySecond(t.arr_q_data[t.curr_q_num]["倒计时间"])),this.timer.loop(1e3,this,this.timeCountDownHandler)}timeCountDownHandler(){this.time_takes<t.arr_q_data[t.curr_q_num]["倒计时间"]?(this.time_takes++,this.countdown_progress_bar.value=this.time_takes/t.arr_q_data[t.curr_q_num]["倒计时间"],this.countdown_rocket.x+=this.rocket_running_gap,this.countdown_block.setTxt(this.GetTimeLeft2BySecond(t.arr_q_data[t.curr_q_num]["倒计时间"]-this.time_takes))):this.timer.clear(this,this.timeCountDownHandler)}readBtnClickHandler(){this.reading_panel.destroyed||(this.setChildIndex(this.reading_panel,this.numChildren-1),this.reading_panel.visible=!0)}setInfoText(t){this.txt_info.text=t.toString(),this.txt_info.y=this.height-this.txt_info.height}destroy(t=!1){this.timer.clear(this,this.timeCountDownHandler),super.destroy(t)}GetTimeLeft2BySecond(t){let i,e,s,h=Math.round((t-1800)/3600),a=Math.round((t-30)/60)%60,r=t%60;return i=0==h?"00":h>0&&h<10?"0"+h:h.toString(),(e=0==a?"00":a>0&&a<10?"0"+a:a.toString())+":"+(s=0==r?"00":r>0&&r<10?"0"+r:r.toString())}asciiToString(t){return String.fromCharCode(t)}stringToAscii(t){return t.charCodeAt(0)}}var b=Laya.Sprite,y=Laya.Text;class x extends Laya.Sprite{constructor(i){super(),this.fill_color="#d2d2d2",this.selected_color=t.main_color,this.selected=!1,this.circle_radius=25,this.rect_width=256,this.rect_height=100,this.radian_to_point_dis=10,this.rect_radius=10,this.rect_path=[["moveTo",this.radian_to_point_dis,0],["lineTo",this.rect_width-this.radian_to_point_dis,0],["arcTo",this.rect_width,0,this.rect_width,this.radian_to_point_dis,this.rect_radius],["lineTo",this.rect_width,this.rect_height-this.radian_to_point_dis],["arcTo",this.rect_width,this.rect_height,this.rect_width-this.radian_to_point_dis,this.rect_height,this.rect_radius],["lineTo",this.radian_to_point_dis,this.rect_height],["arcTo",0,this.rect_height,0,this.rect_height-this.radian_to_point_dis,this.rect_radius],["lineTo",0,this.radian_to_point_dis],["arcTo",0,0,this.radian_to_point_dis,0,this.rect_radius]],this.id=-1,this.pic_url=i,this.pic_rect=new b,this.pic_rect.size(this.rect_width,this.rect_height),this.pic_rect.graphics.drawPath(0,0,this.rect_path,{fillStyle:this.fill_color}),this.pic_rect.x=2*this.circle_radius+5,this.addChild(this.pic_rect),this.choice_circle=new b,this.choice_circle.graphics.drawCircle(this.circle_radius,this.circle_radius,this.circle_radius,this.fill_color),this.choice_circle.size(2*this.circle_radius,2*this.circle_radius),this.choice_circle.y=(this.pic_rect.height-this.choice_circle.height)/2,this.addChild(this.choice_circle),this.txt_choice=new y,this.txt_choice.mouseEnabled=!1,this.txt_choice.fontSize=26,this.txt_choice.text="O",this.txt_choice.pivot(this.txt_choice.width/2,this.txt_choice.height/2),this.txt_choice.pos(this.choice_circle.width/2,this.choice_circle.height/2),this.choice_circle.addChild(this.txt_choice);var e=new b,s=Laya.loader.getRes(this.pic_url);e.size(s.width,s.height),e.graphics.drawTexture(s),e.pivot(e.width/2,e.height/2),e.pos(this.pic_rect.x+this.pic_rect.width/2,this.pic_rect.y+this.pic_rect.height/2),this.addChild(e),this.size(this.pic_rect.x+this.pic_rect.width,this.pic_rect.height),this.choice_circle.on(Laya.Event.CLICK,this,this.circleClickHandler)}onEnable(){}circleClickHandler(){this.event("CHOICEWIDGET_CLICKED",this)}turnSelected(){this.pic_rect.graphics.clear(),this.pic_rect.graphics.drawPath(0,0,this.rect_path,{fillStyle:this.selected_color}),this.choice_circle.graphics.clear(),this.choice_circle.graphics.drawCircle(this.circle_radius,this.circle_radius,this.circle_radius,this.selected_color)}restore(){this.pic_rect.graphics.clear(),this.pic_rect.graphics.drawPath(0,0,this.rect_path,{fillStyle:this.fill_color}),this.choice_circle.graphics.clear(),this.choice_circle.graphics.drawCircle(this.circle_radius,this.circle_radius,this.circle_radius,this.fill_color)}set circleText(t){this.txt_choice.text=t}get circleText(){return this.txt_choice.text}}var m=Laya.Sprite;class q extends w{constructor(t,i){super(t,i),this.widget_updown_gap=30,this.widget_leftright_gap=30,this.selected_id=-1}onEnable(){super.onEnable()}onAssetLoaded(){if(this.big_question_pic=new m,this.big_question_pic.graphics.clear(),""!=t.arr_q_data[t.curr_q_num]["题目主图"]){let i=Laya.loader.getRes("q_comp/questions/"+(t.curr_q_num+1)+"/"+t.arr_q_data[t.curr_q_num]["题目主图"]);this.big_question_pic.graphics.drawTexture(i),this.big_question_pic.size(i.width,i.height),this.big_question_pic.pivot(i.width/2,0)}this.big_question_pic.x=Laya.stage.width/2,this.big_question_pic.y=this.q_type_icon.y+this.q_type_icon.height+30,this.addChild(this.big_question_pic),this.container_countdown.x=this.q_type_icon.x,this.container_countdown.y=this.big_question_pic.y+this.big_question_pic.height+30,this.container_countdown.visible=!0,this.arr_select_pic=new Array;let i=t.arr_q_data[t.curr_q_num]["资源图片名称"].split(","),e=!1;for(let t=0;t<i.length;t++)switch(i[t].substring(0,5)){case"right":this.arr_select_pic.push({pic_name:i[t],selected:!1,right_answer:1});break;case"wrong":this.arr_select_pic.push({pic_name:i[t],selected:!1,right_answer:0});break;case"unsur":e=!0}if(this.a_random)for(let t=this.arr_select_pic.length-1;t>=0;t--){let i=Math.floor(Math.random()*(t+1)),e=this.arr_select_pic[i];this.arr_select_pic[i]=this.arr_select_pic[t],this.arr_select_pic[t]=e}e&&this.arr_select_pic.push({pic_name:"unsure.png",selected:!1,right_answer:2});for(let t=0;t<i.length;t++)this.arr_select_pic[t].select_lab=this.asciiToString(t+this.stringToAscii("A"));let s=[],h=[];this.arr_choice_widget=new Array;for(let i=0;i<this.arr_select_pic.length;i++){let e=new x("q_comp/questions/"+(t.curr_q_num+1)+"/"+this.arr_select_pic[i].pic_name);e.id=i,e.on("CHOICEWIDGET_CLICKED",this,this.selectedHandler),this.addChild(e),e.circleText=this.arr_select_pic[i].select_lab,i%2==0?(h.push(e),e.x=this.widget_leftright_gap):(s.push(e),e.x=Laya.stage.width-e.width-this.widget_leftright_gap),e.y=this.container_countdown.y+this.widget_updown_gap,this.arr_choice_widget.push(e)}for(let t=0;t<h.length;t++)t>0&&(h[t].y=h[t-1].y+h[t-1].height+this.widget_updown_gap);for(let t=0;t<s.length;t++)t>0&&(s[t].y=s[t-1].y+s[t-1].height+this.widget_updown_gap);this.btn_next.disabled=!1}onAssetLoadError(t){}selectedHandler(t){this.selected_id>=0?t.id!=this.selected_id&&(this.arr_choice_widget[this.selected_id].restore(),this.arr_select_pic[this.selected_id].selected=!1,t.turnSelected(),this.selected_id=t.id,this.arr_select_pic[this.selected_id].selected=!0):(this.selected_id=t.id,t.turnSelected(),this.arr_select_pic[this.selected_id].selected=!0),this.btn_next.disabled=!1}btnNextClickHandler(){for(let i=0;i<this.arr_select_pic.length;i++)this.arr_select_pic[i].pic_name="q_comp/questions/"+(t.curr_q_num+1)+"/"+this.arr_select_pic[i].pic_name;let i={"题目类型":t.arr_q_data[t.curr_q_num]["题目类型"],"题目类型标签texture":"q_comp/"+t.arr_q_data[t.curr_q_num]["题目标签"],"读题按钮texture":"q_comp/读题btn.png","题目主图路径":""==t.arr_q_data[t.curr_q_num]["题目主图"]?"":"q_comp/questions/"+(t.curr_q_num+1)+"/"+t.arr_q_data[t.curr_q_num]["题目主图"],"选择组件数据":this.arr_select_pic,"媒体路径":""!=this.media_name?"q_comp/questions/"+(t.curr_q_num+1)+"/"+this.media_name:"","解析":t.arr_q_data[t.curr_q_num]["解析"]};t.arr_finished_data.push(i),super.btnNextClickHandler()}}var k=Laya.Event;class C extends Laya.Sprite{constructor(){if(super(),this.block_width=100,this.block_height=100,this.radian_to_point_dis=10,this.rect_radius=10,this.rect_path=[["moveTo",this.radian_to_point_dis,0],["lineTo",this.block_width-this.radian_to_point_dis,0],["arcTo",this.block_width,0,this.block_width,this.radian_to_point_dis,this.rect_radius],["lineTo",this.block_width,this.block_height-this.radian_to_point_dis],["arcTo",this.block_width,this.block_height,this.block_width-this.radian_to_point_dis,this.block_height,this.rect_radius],["lineTo",this.radian_to_point_dis,this.block_height],["arcTo",0,this.block_height,0,this.block_height-this.radian_to_point_dis,this.rect_radius],["lineTo",0,this.radian_to_point_dis],["arcTo",0,0,this.radian_to_point_dis,0,this.rect_radius]],this.index=-1,this.right_pic_name="",this.right_pic_path="",this.touched_drag_block=null,this.has_default_pic=!1,this.size(this.block_width,this.block_height),this.has_default_pic);else{this.graphics.drawPath(0,0,this.rect_path,{fillStyle:"#ffffff"},{strokeStyle:"#000000",lineWidth:"1"});var t=this.addComponent(Laya.RigidBody);t.type="static",t.allowSleep=!1;var i=this.addComponent(Laya.BoxCollider);i.width=30,i.height=30,i.x=(i.owner.width-i.width)/2,i.y=(i.owner.height-i.height)/2,this.on(k.MOUSE_DOWN,this,this.mouseDownHandler)}}mouseDownHandler(t){var i=t.currentTarget;i.touched_drag_block&&(i.graphics.clear(),i.graphics.drawPath(0,0,this.rect_path,{fillStyle:"#ffffff"},{strokeStyle:"#000000",lineWidth:"1"}),i.touched_drag_block.pos(i.touched_drag_block.parent.mouseX-i.touched_drag_block.width/2,i.touched_drag_block.parent.mouseY-i.touched_drag_block.height/2),i.touched_drag_block.event("START_DRAG",i.touched_drag_block),i.touched_drag_block.startDrag(),i.touched_drag_block=null)}changeToDragBlockSkin(t){this.touched_drag_block=t,this.graphics.clear(),this.graphics.drawTexture(this.touched_drag_block.drag_texture)}changeSkin(t){this.graphics.clear();let i=Laya.loader.getRes(t);this.graphics.drawTexture(i)}}var L=Laya.Event;class f extends Laya.Sprite{constructor(t){super(),this.block_width=100,this.block_height=100,this.$x=0,this.$y=0,this.pic_name="",this.radian_to_point_dis=10,this.rect_radius=10,this.rect_path=[["moveTo",this.radian_to_point_dis,0],["lineTo",this.block_width-this.radian_to_point_dis,0],["arcTo",this.block_width,0,this.block_width,this.radian_to_point_dis,this.rect_radius],["lineTo",this.block_width,this.block_height-this.radian_to_point_dis],["arcTo",this.block_width,this.block_height,this.block_width-this.radian_to_point_dis,this.block_height,this.rect_radius],["lineTo",this.radian_to_point_dis,this.block_height],["arcTo",0,this.block_height,0,this.block_height-this.radian_to_point_dis,this.rect_radius],["lineTo",0,this.radian_to_point_dis],["arcTo",0,0,this.radian_to_point_dis,0,this.rect_radius]],this.index=-1,this.touched_blank_block=null,this.isTouchingBlankBlock=!1,this.pic_path=t,this.pic_name=this.pic_path.substring(this.pic_path.lastIndexOf("/")+1,this.pic_path.lastIndexOf(".png")),this.size(this.block_width,this.block_height),this.drag_texture=Laya.loader.getRes(this.pic_path),this.drag_texture.width=this.width,this.drag_texture.height=this.height,this.graphics.drawTexture(this.drag_texture);var i=this.addComponent(Laya.RigidBody);i.group=-1,i.type="dynamic",i.gravityScale=0,i.allowSleep=!1;var e=this.addComponent(Laya.BoxCollider);e.isSensor=!0,e.width=50,e.height=50,e.x=(e.owner.width-e.width)/2,e.y=(e.owner.height-e.height)/2,this.on(L.MOUSE_DOWN,this,this.dragBlockMouseDownHandler),this.on(L.MOUSE_UP,this,this.dragBlockStopDragHandler);this.addComponent(v)}dragBlockMouseDownHandler(t){this.event("START_DRAG",this),this.startDrag()}dragBlockStopDragHandler(t){this.isTouchingBlankBlock||(this.touched_blank_block=null),this.event("STOP_DRAG",this)}}class v extends Laya.Script{constructor(){super()}onEnable(){}onDisable(){}onTriggerEnter(t,i,e){t.owner;var s=i.owner;s.isTouchingBlankBlock=!0,s.touched_blank_block=t.owner}onTriggerStay(t,i,e){}onTriggerExit(t,i,e){t.owner;i.owner.isTouchingBlankBlock=!1}}var T=Laya.Event,S=Laya.Text;class E extends w{constructor(t,i){super(t,i),this.max_block_in_one_line=6,this.block_gap=0,this.rect_width=100,this.rect_height=100}onEnable(){super.onEnable()}onAssetLoaded(){this.container_countdown.x=this.q_type_icon.x,this.container_countdown.y=this.q_type_icon.y+this.q_type_icon.height+30,this.container_countdown.visible=!0;let i=new S;i.fontSize=25,i.text="作答区",i.color="#747474",i.x=this.q_type_icon.x,i.y=this.container_countdown.y+this.container_countdown.height+15,this.addChild(i),this.block_gap=(Laya.stage.width-2*this.q_type_icon.x-this.rect_width*this.max_block_in_one_line)/(this.max_block_in_one_line-1);let e,s=0,h=t.arr_q_data[t.curr_q_num]["资源图片名称"].split(","),a=!1;this.arr_drag_block=new Array;for(let i=0;i<h.length;i++){let r;switch(h[i].substring(0,5)){case"right":s++,(r=new f("q_comp/questions/"+(t.curr_q_num+1)+"/"+h[i])).index=i,r.on("START_DRAG",this,this.startDragHandler),r.on("STOP_DRAG",this,this.stopDragHandler),this.arr_drag_block.push(r);break;case"wrong":(r=new f("q_comp/questions/"+(t.curr_q_num+1)+"/"+h[i])).index=i,r.on("START_DRAG",this,this.startDragHandler),r.on("STOP_DRAG",this,this.stopDragHandler),this.arr_drag_block.push(r);break;case"unsur":e=h[i],a=!0}}if(this.a_random)for(let t=this.arr_drag_block.length-1;t>=0;t--){let i=Math.floor(Math.random()*(t+1)),e=this.arr_drag_block[i];this.arr_drag_block[i]=this.arr_drag_block[t],this.arr_drag_block[t]=e}if(a){let i=new f("q_comp/questions/"+(t.curr_q_num+1)+"/"+e);i.index=this.arr_drag_block.length,i.on("START_DRAG",this,this.startDragHandler),i.on("STOP_DRAG",this,this.stopDragHandler),this.arr_drag_block.push(i)}this.arr_blank_block=new Array;for(let e=0;e<t.arr_q_data[t.curr_q_num]["空白块数目"];e++){let h=new C;e<s?(h.right_pic_name="right"+(e+1),h.right_pic_path=`q_comp/questions/${t.curr_q_num+1}/right${e+1}.png`):(h.right_pic_name="",h.right_pic_path=""),h.index=e,h.x=this.q_type_icon.x+e%this.max_block_in_one_line*(this.block_gap+h.width),h.y=i.y+i.height+15+Math.floor(e/this.max_block_in_one_line)*(this.block_gap+h.height),this.addChild(h),this.arr_blank_block.push(h)}let r=new S;r.fontSize=25,r.text="选项区",r.color="#747474",r.x=i.x,r.y=this.arr_blank_block[this.arr_blank_block.length-1].y+this.arr_blank_block[this.arr_blank_block.length-1].height+30,this.addChild(r);for(let t=0;t<this.arr_drag_block.length;t++){this.arr_drag_block[t].x=this.q_type_icon.x+t%this.max_block_in_one_line*(this.block_gap+this.arr_drag_block[t].width),this.arr_drag_block[t].y=r.y+r.height+Math.floor(t/this.max_block_in_one_line)*(this.block_gap+this.arr_drag_block[t].height)+15,this.arr_drag_block[t].$x=this.arr_drag_block[t].x,this.arr_drag_block[t].$y=this.arr_drag_block[t].y;let i=this.arr_drag_block[t].drag_texture;this.graphics.drawTexture(i,this.arr_drag_block[t].x,this.arr_drag_block[t].y),this.addChild(this.arr_drag_block[t])}this.reading_panel&&this.setChildIndex(this.reading_panel,this.numChildren-1),Laya.stage.on(T.MOUSE_OUT,this,this.dragOutStageHandler),this.btn_next.disabled=!1}onAssetLoadError(t){}startDragHandler(t){this.dragging_block=t,this.setChildIndex(this.dragging_block,this.numChildren-1)}stopDragHandler(t){t.touched_blank_block?(t.touched_blank_block.changeToDragBlockSkin(t),this.dragging_block.x=this.dragging_block.$x,this.dragging_block.y=this.dragging_block.$y):Laya.Tween.to(this.dragging_block,{x:this.dragging_block.$x,y:this.dragging_block.$y},100),this.dragging_block=null}btnNextClickHandler(){let i=new Array;for(let e=0;e<t.arr_q_data[t.curr_q_num]["空白块数目"];e++)i.push(this.arr_blank_block[e]);let e={"题目类型":t.arr_q_data[t.curr_q_num]["题目类型"],"题目类型标签texture":"q_comp/"+t.arr_q_data[t.curr_q_num]["题目标签"],"读题按钮texture":"q_comp/读题btn.png","媒体路径":""!=this.media_name?"q_comp/questions/"+(t.curr_q_num+1)+"/"+this.media_name:"","方块数据":i,"每行的方块数目":this.max_block_in_one_line,"解析":t.arr_q_data[t.curr_q_num]["解析"]};t.arr_finished_data.push(e),super.btnNextClickHandler()}dragOutStageHandler(t){this.dragging_block&&(Laya.Tween.to(this.dragging_block,{x:this.dragging_block.$x,y:this.dragging_block.$y},100),this.dragging_block.touched_blank_block=null,this.dragging_block=null)}}var F=Laya.Sprite;class A extends w{constructor(t,i){super(t,i),this.widget_updown_gap=30,this.widget_leftright_gap=30}onEnable(){super.onEnable()}onAssetLoaded(){if(this.question_pic=new F,this.question_pic.graphics.clear(),""!=t.arr_q_data[t.curr_q_num]["题目主图"]){let i=Laya.loader.getRes("q_comp/questions/"+(t.curr_q_num+1)+"/"+t.arr_q_data[t.curr_q_num]["题目主图"]);this.question_pic.size(i.width,i.height),this.question_pic.graphics.drawTexture(i)}this.question_pic.x=(Laya.stage.width-this.question_pic.width)/2,this.question_pic.y=this.q_type_icon.y+this.q_type_icon.height+30,this.question_pic.small_x=this.question_pic.x,this.question_pic.small_y=this.question_pic.y,this.question_pic.isSmallPic=!0,this.addChild(this.question_pic),this.container_countdown.x=this.q_type_icon.x,this.container_countdown.y=this.question_pic.y+this.question_pic.height+30,this.container_countdown.visible=!0,this.arr_select_pic=new Array;let i=t.arr_q_data[t.curr_q_num]["资源图片名称"].split(","),e=!1;for(let t=0;t<i.length;t++)switch(i[t].substring(0,5)){case"right":this.arr_select_pic.push({pic_name:i[t],selected:!1,right_answer:1});break;case"wrong":this.arr_select_pic.push({pic_name:i[t],selected:!1,right_answer:0});break;case"unsur":e=!0}if(this.a_random)for(let t=this.arr_select_pic.length-1;t>=0;t--){let i=Math.floor(Math.random()*(t+1)),e=this.arr_select_pic[i];this.arr_select_pic[i]=this.arr_select_pic[t],this.arr_select_pic[t]=e}e&&this.arr_select_pic.push({pic_name:"unsure.png",selected:!1,right_answer:2});for(let t=0;t<i.length;t++)this.arr_select_pic[t].select_lab=this.asciiToString(t+this.stringToAscii("A"));let s=[],h=[];this.arr_choice_widget=new Array;for(let i=0;i<this.arr_select_pic.length;i++){let e=new x("q_comp/questions/"+(t.curr_q_num+1)+"/"+this.arr_select_pic[i].pic_name);e.id=i,e.on("CHOICEWIDGET_CLICKED",this,this.selectedHandler),this.addChild(e),e.circleText=this.arr_select_pic[i].select_lab,i%2==0?(h.push(e),e.x=this.widget_leftright_gap):(s.push(e),e.x=Laya.stage.width-e.width-this.widget_leftright_gap),e.y=this.container_countdown.y+this.widget_updown_gap,this.arr_choice_widget.push(e)}for(let t=0;t<h.length;t++)t>0&&(h[t].y=h[t-1].y+h[t-1].height+this.widget_updown_gap);for(let t=0;t<s.length;t++)t>0&&(s[t].y=s[t-1].y+s[t-1].height+this.widget_updown_gap);this.btn_next.disabled=!1}onAssetLoadError(t){}selectedHandler(t){t.selected=!t.selected,t.selected?(this.arr_select_pic[t.id].selected=!0,t.turnSelected()):(this.arr_select_pic[t.id].selected=!1,t.restore()),this.btn_next.disabled=!1}btnNextClickHandler(){for(let i=0;i<this.arr_select_pic.length;i++)this.arr_select_pic[i].pic_name="q_comp/questions/"+(t.curr_q_num+1)+"/"+this.arr_select_pic[i].pic_name;let i={"题目类型":t.arr_q_data[t.curr_q_num]["题目类型"],"题目类型标签texture":"q_comp/"+t.arr_q_data[t.curr_q_num]["题目标签"],"读题按钮texture":"q_comp/读题btn.png","题目主图路径":""==t.arr_q_data[t.curr_q_num]["题目主图"]?"":"q_comp/questions/"+(t.curr_q_num+1)+"/"+t.arr_q_data[t.curr_q_num]["题目主图"],"选择组件数据":this.arr_select_pic,"媒体路径":""!=this.media_name?"q_comp/questions/"+(t.curr_q_num+1)+"/"+this.media_name:"","解析":t.arr_q_data[t.curr_q_num]["解析"]};t.arr_finished_data.push(i),super.btnNextClickHandler()}}var z=Laya.Sprite,D=Laya.Button,H=Laya.Event;class R extends z{constructor(){super(),this.btn_skin_path="q_comp/button.png"}onEnable(){super.onEnable(),this.btn_start=new D(this.btn_skin_path),this.btn_start.labelSize=26,this.btn_start.label="开始答题",this.btn_start.pivot(this.btn_start.width/2,this.btn_start.height/2),this.btn_start.x=Laya.stage.width/2,this.btn_start.y=Laya.stage.height-3*this.btn_start.height,this.btn_start.labelColors="#FFFFFF",this.addChild(this.btn_start),this.btn_start.on(H.CLICK,this,this.btnStartClickHandler)}btnStartClickHandler(){this.btn_start.off(H.CLICK,this,this.btnStartClickHandler),this.event("START_TEST"),this.destroy(!0)}onDisable(){}}var B=Laya.Text;class I extends Laya.Sprite{constructor(t){super(),this.bar_height=100,this.total_questions=0,this.total_time=t}onEnable(){this.size(Laya.stage.width,this.bar_height),this.graphics.drawRect(0,0,Laya.stage.width,this.bar_height,t.main_color),this.txt_static=new B,this.txt_static.fontSize=20,this.txt_static.color="#FFFFFF",this.txt_static.text="已用时",this.txt_static.pivot(this.txt_static.width/2,this.txt_static.height),this.txt_static.x=this.width/2,this.txt_static.y=this.height-3,this.addChild(this.txt_static),this.txt_q_index=new B,this.txt_q_index.fontSize=24,this.txt_q_index.color="#FFFFFF",this.txt_q_index.align="right",this.addChild(this.txt_q_index),this.txt_total_time=new B,this.txt_total_time.fontSize=36,this.txt_total_time.color="#FFFFFF",this.txt_total_time.text="00:00:00",this.txt_total_time.pivot(this.txt_total_time.width/2,this.txt_total_time.height/2),this.txt_total_time.x=this.width/2,this.txt_total_time.y=this.height/2,this.addChild(this.txt_total_time),this.timeStart()}timeStart(){var t=0;this.timer.loop(1e3,this,function(){var i,e,s;t++,this.hh=Math.round((t-1800)/3600),this.mm=Math.round((t-30)/60)%60,this.ss=t%60,i=this.hh.toString().length>1?this.hh.toString():"0"+this.hh.toString(),e=this.mm.toString().length>1?this.mm.toString():"0"+this.mm.toString(),s=this.ss.toString().length>1?this.ss.toString():"0"+this.ss.toString(),this.txt_total_time.text=i+":"+e+":"+s,t>=this.total_time&&(this.event("TIMES_UP"),this.timer.clearAll(this))})}setTotalQuestions(t){this.total_questions=t}setQuestionIndex(t){this.txt_q_index.text="第"+t+"题/共"+this.total_questions+"题",this.txt_q_index.pivot(this.txt_q_index.width,this.txt_q_index.height/2),this.txt_q_index.x=this.width-5,this.txt_q_index.y=this.height/2}}var M=Laya.Sprite,O=Laya.Event,P=Laya.Button,N=Laya.Text,K=Laya.Panel;class G extends M{constructor(){super(),this.bar_height=100,this.question_index=0,this.edge_gap=30,this.btn_skin_path="q_comp/button.png",this.vScrollBarSkin="q_comp/vscroll.png",this.size(Laya.stage.width,Laya.stage.height),this.graphics.drawRect(0,0,this.width,this.bar_height,t.main_color),this.graphics.drawRect(0,this.bar_height,this.width,this.height-this.bar_height,"#0096FF");let i=new M;i.size(100,this.bar_height),i.graphics.drawRect(0,0,i.width,i.height,"#FFFFFF99"),i.on(O.CLICK,this,()=>{this.q_video&&(this.q_video.removeVideo(),this.q_video=null);let t=this.question_container.numChildren;for(let i=0;i<t;i++)this.question_container.getChildAt(0).destroy(!0);this.visible=!1});let e=new N;e.mouseEnabled=!1,e.fontSize=22,e.color="#666666",e.text="返回",e.pivotX=e.width/2,e.pivotY=e.height/2,e.pos(i.width/2,i.height/2),i.addChild(e),this.addChild(i),this.txt_title=new N,this.txt_title.fontSize=28,this.txt_title.color="#FFFFFF",this.txt_title.text=`第${this.question_index}题`,this.txt_title.pivotX=this.txt_title.width/2,this.txt_title.pivotY=this.txt_title.height/2,this.txt_title.pos(this.width/2,this.bar_height/2),this.addChild(this.txt_title),this.question_container=new K,this.question_container.size(this.width,this.height-this.bar_height),this.question_container.vScrollBarSkin=this.vScrollBarSkin,this.question_container.vScrollBar.hide=!0,this.question_container.vScrollBar.elasticDistance=100,this.question_container.vScrollBar.elasticBackTime=200,this.question_container.vScrollBar.sizeGrid="10,10,10,10,1",this.question_container.graphics.drawRect(0,0,this.question_container.width,this.question_container.height,"#D9EFFF"),this.question_container.y=this.bar_height,this.addChild(this.question_container)}showAndUpdateQuestion(i){switch(this.setTitleText(i),t.arr_finished_data[i-1]["题目类型"]){case"单选题":this.showChoice(t.arr_finished_data[i-1]);break;case"多选题":this.showCheck(t.arr_finished_data[i-1]);break;case"拖动题":this.showDrag(t.arr_finished_data[i-1])}}setTitleText(t){this.question_index=t,this.txt_title.text=`第${this.question_index}题`,this.txt_title.pivotX=this.txt_title.width/2,this.txt_title.pivotY=this.txt_title.height/2,this.txt_title.pos(this.width/2,this.bar_height/2)}showChoice(t){let i=new M;i.x=this.edge_gap,i.y=this.edge_gap;let e=Laya.loader.getRes(t["题目类型标签texture"]);if(i.size(e.width,e.height),i.graphics.drawTexture(e),this.question_container.addChild(i),""!=t["媒体路径"]){let e=new M,h=Laya.loader.getRes(t["读题按钮texture"]);switch(e.graphics.drawTexture(h),e.size(h.width,h.height),e.x=this.question_container.width-e.width-this.edge_gap,e.y=i.y,this.question_container.addChild(e),t["媒体路径"].substr(t["媒体路径"].lastIndexOf("."),t["媒体路径"].length)){case".mp3":let a;(a=new o(this.question_container.width,this.question_container.height,t["媒体路径"])).visible=!1,this.question_container.addChild(a),e.on(O.CLICK,this,()=>{a.zOrder=this.question_container.numChildren-1,a.visible=!0});break;case".mp4":let r=new M;r.size(this.question_container.width,this.question_container.height),r.graphics.drawRect(0,0,r.width,r.height,"#FFFFE7"),r.visible=!1,this.question_container.addChild(r);let n=new P(this.btn_skin_path,"关闭视频");n.labelSize=20,n.pivotX=n.width/2,n.x=this.question_container.width/2,n.y=this.question_container.height-n.height-this.edge_gap,r.addChild(n);let _=new M;_.size(r.width,n.y-this.edge_gap),_.graphics.drawRect(0,0,_.width,n.y-this.edge_gap,"#000000"),r.addChild(_),e.on(O.CLICK,this,()=>{r.zOrder=this.question_container.numChildren-1,r.visible=!0,this.q_video=new s(t["媒体路径"],_)}),n.on(O.CLICK,this,()=>{r.visible=!1,this.q_video&&(this.q_video.removeVideo(),this.q_video=null)})}}let h=new M;if(""!=t["题目主图路径"]){let i=Laya.loader.getRes(t["题目主图路径"]);h.graphics.drawTexture(i),h.size(i.width,i.height),h.pivot(i.width/2,0)}h.x=this.question_container.width/2,h.y=i.y+i.height+this.edge_gap,this.question_container.addChild(h);let a,r=new N;r.fontSize=22,r.color="#000000",r.text="你的答案：",r.pos(this.edge_gap,h.y+h.height+this.edge_gap),this.question_container.addChild(r);let n=new Array;for(let i=0;i<t["选择组件数据"].length;i++){let e=new x(t["选择组件数据"][i].pic_name);e.circleText=t["选择组件数据"][i].select_lab,t["选择组件数据"][i].selected&&e.turnSelected(),1==t["选择组件数据"][i].right_answer&&(a=t["选择组件数据"][i].select_lab),n.push(e),this.question_container.addChild(e)}this.equidistribution(n,r.y+r.height,this.edge_gap,2,this.edge_gap,this.question_container.width);let _=new N;_.fontSize=22,_.color="#000000",_.text=`正确答案：${a}`,_.pos(this.edge_gap,n[n.length-1].y+n[n.length-1].height+this.edge_gap),this.question_container.addChild(_);let d=new N;d.fontSize=22,d.leading=10,d.width=this.question_container.width-2*this.edge_gap,d.wordWrap=!0,d.color="#000000",d.text="解析：\n"+t["解析"],d.pos(this.edge_gap,_.y+_.height+this.edge_gap),this.question_container.addChild(d)}showCheck(t){let i=new M;i.x=this.edge_gap,i.y=this.edge_gap;let e=Laya.loader.getRes(t["题目类型标签texture"]);if(i.size(e.width,e.height),i.graphics.drawTexture(e),this.question_container.addChild(i),""!=t["媒体路径"]){let e=new M,h=Laya.loader.getRes(t["读题按钮texture"]);switch(e.graphics.drawTexture(h),e.size(h.width,h.height),e.x=this.question_container.width-e.width-this.edge_gap,e.y=i.y,this.question_container.addChild(e),t["媒体路径"].substr(t["媒体路径"].lastIndexOf("."),t["媒体路径"].length)){case".mp3":let a;(a=new o(this.question_container.width,this.question_container.height,t["媒体路径"])).visible=!1,this.question_container.addChild(a),e.on(O.CLICK,this,()=>{a.zOrder=this.question_container.numChildren-1,a.visible=!0});break;case".mp4":let r=new M;r.size(this.question_container.width,this.question_container.height),r.graphics.drawRect(0,0,r.width,r.height,"#FFFFE7"),r.visible=!1,this.question_container.addChild(r);let n=new P(this.btn_skin_path,"关闭视频");n.labelSize=20,n.pivotX=n.width/2,n.x=this.question_container.width/2,n.y=this.question_container.height-n.height-this.edge_gap,r.addChild(n);let _=new M;_.size(r.width,n.y-this.edge_gap),_.graphics.drawRect(0,0,_.width,n.y-this.edge_gap,"#000000"),r.addChild(_),e.on(O.CLICK,this,()=>{r.zOrder=this.question_container.numChildren-1,r.visible=!0,this.q_video=new s(t["媒体路径"],_)}),n.on(O.CLICK,this,()=>{r.visible=!1,this.q_video&&(this.q_video.removeVideo(),this.q_video=null)})}}let h=new M;if(""!=t["题目主图路径"]){let i=Laya.loader.getRes(t["题目主图路径"]);h.graphics.drawTexture(i),h.size(i.width,i.height),h.pivot(i.width/2,0)}h.x=this.question_container.width/2,h.y=i.y+i.height+this.edge_gap,this.question_container.addChild(h);let a=new N;a.fontSize=22,a.color="#000000",a.text="你的答案：",a.pos(this.edge_gap,h.y+h.height+this.edge_gap),this.question_container.addChild(a);let r="",n=new Array;for(let i=0;i<t["选择组件数据"].length;i++){let e=new x(t["选择组件数据"][i].pic_name);e.circleText=t["选择组件数据"][i].select_lab,t["选择组件数据"][i].selected&&e.turnSelected(),1==t["选择组件数据"][i].right_answer&&(r=r+t["选择组件数据"][i].select_lab+" "),n.push(e),this.question_container.addChild(e)}this.equidistribution(n,a.y+a.height,this.edge_gap,2,this.edge_gap,this.question_container.width);let _=new N;_.fontSize=22,_.color="#000000",_.text=`正确答案：${r}`,_.pos(this.edge_gap,n[n.length-1].y+n[n.length-1].height+this.edge_gap),this.question_container.addChild(_);let d=new N;d.fontSize=22,d.leading=10,d.width=this.question_container.width-2*this.edge_gap,d.wordWrap=!0,d.color="#000000",d.text="解析：\n"+t["解析"],d.pos(this.edge_gap,_.y+_.height+this.edge_gap),this.question_container.addChild(d)}showDrag(t){let i=new M;i.x=this.edge_gap,i.y=this.edge_gap;let e=Laya.loader.getRes(t["题目类型标签texture"]);if(i.size(e.width,e.height),i.graphics.drawTexture(e),this.question_container.addChild(i),""!=t["媒体路径"]){let e=new M,h=Laya.loader.getRes(t["读题按钮texture"]);switch(e.graphics.drawTexture(h),e.size(h.width,h.height),e.x=this.question_container.width-e.width-this.edge_gap,e.y=i.y,this.question_container.addChild(e),t["媒体路径"].substr(t["媒体路径"].lastIndexOf("."),t["媒体路径"].length)){case".mp3":let a;(a=new o(this.question_container.width,this.question_container.height,t["媒体路径"])).visible=!1,this.question_container.addChild(a),e.on(O.CLICK,this,()=>{a.zOrder=this.question_container.numChildren-1,a.visible=!0});break;case".mp4":let r=new M;r.size(this.question_container.width,this.question_container.height),r.graphics.drawRect(0,0,r.width,r.height,"#FFFFE7"),r.visible=!1,this.question_container.addChild(r);let n=new P(this.btn_skin_path,"关闭视频");n.labelSize=20,n.pivotX=n.width/2,n.x=this.question_container.width/2,n.y=this.question_container.height-n.height-this.edge_gap,r.addChild(n);let _=new M;_.size(r.width,n.y-this.edge_gap),_.graphics.drawRect(0,0,_.width,n.y-this.edge_gap,"#000000"),r.addChild(_),e.on(O.CLICK,this,()=>{r.zOrder=this.question_container.numChildren-1,r.visible=!0,this.q_video=new s(t["媒体路径"],_)}),n.on(O.CLICK,this,()=>{r.visible=!1,this.q_video&&(this.q_video.removeVideo(),this.q_video=null)})}}let h=new N;h.fontSize=22,h.color="#000000",h.text="你的答案：",h.pos(this.edge_gap,i.y+i.height+this.edge_gap),this.question_container.addChild(h);let a=0;for(let i=0;i<t["方块数据"].length;i++){let e=new C;e.mouseEnabled=!1,0===i&&(a=(this.question_container.width-2*this.edge_gap-e.width*t["每行的方块数目"])/(t["每行的方块数目"]-1)),t["方块数据"][i].touched_drag_block&&e.changeToDragBlockSkin(t["方块数据"][i].touched_drag_block),e.x=this.edge_gap+i%t["每行的方块数目"]*(a+e.width),e.y=h.y+h.height+15+Math.floor(i/t["每行的方块数目"])*(a+e.height),this.question_container.addChild(e)}let r=new N;r.fontSize=22,r.color="#000000",r.text="正确答案：",r.pos(this.edge_gap,this.question_container.getChildAt(this.question_container.numChildren-1).y+this.question_container.getChildAt(this.question_container.numChildren-1).height+this.edge_gap),this.question_container.addChild(r);for(let i=0;i<t["方块数据"].length;i++){let e=new C;e.mouseEnabled=!1,0===i&&(a=(this.question_container.width-2*this.edge_gap-e.width*t["每行的方块数目"])/(t["每行的方块数目"]-1)),""!=t["方块数据"][i].right_pic_path&&e.changeSkin(t["方块数据"][i].right_pic_path),e.x=this.edge_gap+i%t["每行的方块数目"]*(a+e.width),e.y=r.y+r.height+15+Math.floor(i/t["每行的方块数目"])*(a+e.height),this.question_container.addChild(e)}let n=new N;n.fontSize=22,n.leading=10,n.width=this.question_container.width-2*this.edge_gap,n.wordWrap=!0,n.color="#000000",n.text="解析：\n"+t["解析"],n.pos(this.edge_gap,this.question_container.getChildAt(this.question_container.numChildren-1).y+this.question_container.getChildAt(this.question_container.numChildren-1).height+this.edge_gap),this.question_container.addChild(n)}equidistribution(t,i=0,e=0,s=10,h=50,a=720){let r,n,_;for(let o=0;o<t.length;o++)0==o&&(r=t[o].width,n=t[o].height,_=(a-2*e-r)/(s-1)),t[o].x=o%s*_+e,t[o].y=Math.floor(o/s)*(n+h)+i+e}}var V,$=Laya.Sprite,U=Laya.Event,W=Laya.Text,X=Laya.Panel;class Q extends ${constructor(){super(),this.bar_height=100,this.selected_spot_id=-1,this.vScrollBarSkin="q_comp/vscroll.png",this.text_spot_num_one_row=10,this.gap_to_edge=50,this.linespace=30,this.size(Laya.stage.width,Laya.stage.height),this.graphics.drawRect(0,0,this.width,this.bar_height,t.main_color),this.graphics.drawRect(0,this.bar_height,this.width,this.height-this.bar_height,"#FFFF99");let i=new W;i.fontSize=28,i.color="#FFFFFF",i.text="查看解析",i.pivotX=i.width/2,i.pivotY=i.height/2,i.pos(this.width/2,this.bar_height/2),this.addChild(i);let e=new $;e.size(100,this.bar_height),e.graphics.drawRect(0,0,e.width,e.height,"#FFFFFF99"),e.on(U.CLICK,this,()=>{this.visible=!1,this.selected_spot_id>=0&&(this.arr_textspot[this.selected_spot_id].isselected=!1,this.selected_spot_id=-1)});let s=new W;s.mouseEnabled=!1,s.fontSize=22,s.color="#666666",s.text="返回",s.pivotX=s.width/2,s.pivotY=s.height/2,s.pos(e.width/2,e.height/2),e.addChild(s),this.addChild(e),this.panel=new X,this.panel.size(this.width,this.height-this.bar_height),this.panel.vScrollBarSkin=this.vScrollBarSkin,this.panel.vScrollBar.hide=!0,this.panel.vScrollBar.elasticDistance=100,this.panel.vScrollBar.elasticBackTime=200,this.panel.vScrollBar.sizeGrid="10,10,10,10,1",this.gap_to_edge=this.panel.vScrollBar.width+10,this.panel.y=this.bar_height,this.addChild(this.panel),this.arr_textspot=new Array;for(let i=0;i<t.arr_finished_data.length;i++){let e=new Y(i+1,t.arr_finished_data[i]["正确"]);e.id=i,e.on(U.CLICK,this,t=>{let i=t.currentTarget;this.selected_spot_id<0?(this.selected_spot_id=i.id,e.isselected=!0):this.selected_spot_id!=i.id&&(e.isselected=!0,this.arr_textspot[this.selected_spot_id].isselected=!1,this.selected_spot_id=i.id),this.event("SHOW_ANALYZE_DETAIL",i.id)}),this.arr_textspot.push(e)}this.equidistribution(this.arr_textspot,0,this.gap_to_edge,this.text_spot_num_one_row,this.linespace,this.width);for(let i=0;i<t.arr_finished_data.length;i++)this.panel.addChild(this.arr_textspot[i]);var h=new $;h.y=this.arr_textspot[this.arr_textspot.length-1].y+this.arr_textspot[this.arr_textspot.length-1].height+this.gap_to_edge,this.panel.addChild(h)}equidistribution(t,i=0,e=0,s=10,h=50,a=720){let r,n,_;for(let o=0;o<t.length;o++)0==o&&(r=t[o].width,n=t[o].height,_=(a-2*e-r)/(s-1)),t[o].x=o%s*_+e,t[o].y=Math.floor(o/s)*(n+h)+i+e}}class Y extends ${constructor(t,i){super(),this._id=0,this.radius=30,this.ring_radius=this.radius+6,this.selected=!1,this.ring_path=[["moveTo",0,this.ring_radius],["arcTo",0,0,this.ring_radius,0,this.ring_radius],["arcTo",2*this.ring_radius,0,2*this.ring_radius,this.ring_radius,this.ring_radius],["arcTo",2*this.ring_radius,2*this.ring_radius,this.ring_radius,2*this.ring_radius,this.ring_radius],["arcTo",0,2*this.ring_radius,0,this.ring_radius,this.ring_radius]],this.correct=i,this.width=2*this.radius,this.height=2*this.radius,this.drawCircle(this.correct),this.txt_no=new W,this.txt_no.fontSize=26,this.txt_no.text=t.toString(),this.txt_no.pivot(this.txt_no.width/2,this.txt_no.height/2),this.txt_no.pos(this.width/2,this.height/2),this.addChild(this.txt_no)}drawCircle(t){this.graphics.drawCircle(this.radius,this.radius,this.radius,t?V.right:V.wrong)}setText(t){this.txt_no.text=t}set isselected(t){t?this.graphics.drawPath(-(this.ring_radius-this.radius),-(this.ring_radius-this.radius),this.ring_path,{fillStyle:"#00000000"},{strokeStyle:"#ff000077",lineWidth:"3"}):(this.graphics.clear(),this.drawCircle(this.correct)),this.selected=t}get isselected(){return this.selected}set id(t){this._id=t}get id(){return this._id}}!function(t){t.right="#54B537",t.wrong="#FF0000"}(V||(V={}));var J=Laya.Sprite,j=Laya.Event,Z=Laya.Button,tt=Laya.Text;class it extends Laya.Sprite{constructor(){super(),this.radian_to_point_dis=10,this.rect_radius=10,this.btn_skin_path="q_comp/button.png",this.total_count=t.arr_finished_data.length,this.right_count=0,this.score=0,this.size(Laya.stage.width,Laya.stage.height),this.graphics.drawRect(0,0,this.width,this.height,"#E7F2BC"),this.block_width=this.width-20,this.block_height=this.height/3,this.main_container=new J,this.main_container.size(this.block_width,this.block_height),this.rect_path=[["moveTo",this.radian_to_point_dis,0],["lineTo",this.block_width-this.radian_to_point_dis,0],["arcTo",this.block_width,0,this.block_width,this.radian_to_point_dis,this.rect_radius],["lineTo",this.block_width,this.block_height-this.radian_to_point_dis],["arcTo",this.block_width,this.block_height,this.block_width-this.radian_to_point_dis,this.block_height,this.rect_radius],["lineTo",this.radian_to_point_dis,this.block_height],["arcTo",0,this.block_height,0,this.block_height-this.radian_to_point_dis,this.rect_radius],["lineTo",0,this.radian_to_point_dis],["arcTo",0,0,this.radian_to_point_dis,0,this.rect_radius]],this.main_container.graphics.drawPath(0,0,this.rect_path,{fillStyle:"#ffffff"},{strokeStyle:"#00000055",lineWidth:"1"}),this.main_container.pivot(this.main_container.width/2,this.main_container.height/2),this.main_container.pos(this.width/2,this.height/2),this.txt_result=new tt,this.txt_result.fontSize=28,this.scoreCalculate(),this.score=Number((this.right_count/this.total_count*100).toFixed(2)),this.txt_result.text=`共${this.total_count}题，答对${this.right_count}题，成绩：${this.score}分`,this.main_container.addChild(this.txt_result),this.btn_restart=new Z(this.btn_skin_path),this.btn_restart.labelSize=26,this.btn_restart.y=this.main_container.height-this.btn_restart.height-10,this.btn_restart.labelColors="#FFFFFF",this.btn_restart.label="重新开始",this.btn_restart.on(j.CLICK,this,this.btnRestartClickHandler),this.btn_analysis=new Z(this.btn_skin_path),this.btn_analysis.labelSize=26,this.btn_analysis.y=this.btn_restart.y,this.btn_analysis.labelColors="#FFFFFF",this.btn_analysis.label="查看解析",this.btn_analysis.on(j.CLICK,this,this.btnAnalysisClickHandler);this.btn_restart.x=(this.main_container.width-100)/2-this.btn_restart.width,this.btn_analysis.x=this.btn_restart.x+this.btn_restart.width+100,this.main_container.addChild(this.btn_analysis),this.main_container.addChild(this.btn_restart),this.addChild(this.main_container),this.sp_showcounts=new Q,this.sp_showcounts.on("SHOW_ANALYZE_DETAIL",this,this.showAnalyzeDetailHandler),this.sp_showcounts.visible=!1,this.addChild(this.sp_showcounts),this.question_analyze=new G,this.question_analyze.visible=!1,this.addChild(this.question_analyze)}btnRestartClickHandler(){t.curr_q_num=0,this.event("RESTART_BTN_CLICK")}btnAnalysisClickHandler(){this.sp_showcounts.visible=!0}showAnalyzeDetailHandler(t){this.question_analyze.visible=!0,this.question_analyze.showAndUpdateQuestion(t+1)}scoreCalculate(){for(let i=0;i<t.arr_finished_data.length;i++)switch(t.arr_finished_data[i]["正确"]=!1,t.arr_finished_data[i]["题目类型"]){case"单选题":this.choiceDataHandle(t.arr_finished_data[i]);break;case"多选题":this.checkDataHandle(t.arr_finished_data[i]);break;case"拖动题":this.dragDataHandle(t.arr_finished_data[i])}}choiceDataHandle(t){if("单选题"==t["题目类型"])for(let i=0;i<t["选择组件数据"].length;i++)if(t["选择组件数据"][i].selected&&1==t["选择组件数据"][i].right_answer){this.right_count++,t["正确"]=!0;break}}checkDataHandle(t){if("多选题"==t["题目类型"])for(let i=0;i<t["选择组件数据"].length&&!(t["选择组件数据"][i].selected&&1!=t["选择组件数据"][i].right_answer||1==t["选择组件数据"][i].right_answer&&!t["选择组件数据"][i].selected);i++)i==t["选择组件数据"].length-1&&(this.right_count++,t["正确"]=!0)}dragDataHandle(t){if("拖动题"==t["题目类型"])for(let i=0;i<t["方块数据"].length;i++){if(t["方块数据"][i].touched_drag_block){if(t["方块数据"][i].right_pic_name!=t["方块数据"][i].touched_drag_block.pic_name)break}else if(""!=t["方块数据"][i].right_pic_name)break;i==t["方块数据"].length-1&&(this.right_count++,t["正确"]=!0)}}}var et=Laya.Event,st=Laya.ProgressBar,ht=Laya.Handler;class at extends Laya.Script{constructor(){super(),this.progress_bar_skin_path="q_comp/progress.png",this.q_random=!1,this.total_time=3600}onEnable(){super.onEnable(),Laya.loader.load("res/atlas/q_comp.atlas",ht.create(this,this.onProgressLoaded))}onProgressLoaded(){this.progress_bar=new st(this.progress_bar_skin_path),this.progress_bar.pivotX=this.progress_bar.width/2,this.progress_bar.pivotY=this.progress_bar.height/2,this.progress_bar.pos(Laya.stage.width/2,Laya.stage.height/2),this.owner.addChild(this.progress_bar),this.arr_assets=new Array,this.arr_assets.push({url:"data/q_data.json",type:Laya.Loader.JSON}),this.arr_assets.push({url:"res/atlas/q_comp/play_btn.atlas",type:Laya.Loader.ATLAS}),Laya.loader.retryNum=3,Laya.loader.load(this.arr_assets,ht.create(this,this.onAssetLoaded),ht.create(this,this.onAssetLoading,null,!1)),Laya.loader.on(et.ERROR,this,this.onAssetLoadError)}onAssetLoading(t){this.progress_bar.value=t}onAssetLoadError(t){}onAssetLoaded(){this.progress_bar.destroy(!0);var i=Laya.loader.getRes(this.arr_assets[0].url);for(var e in i)t.arr_q_data.push(i[e]);t.total_q_num=t.arr_q_data.length,this.q_random&&t.arr_q_data.sort(function(){return.5-Math.random()}),this.sp_start_page=new R,this.owner.addChild(this.sp_start_page),this.sp_start_page.on("START_TEST",this,this.startTestHandler)}startTestHandler(){this.sp_start_page.off("START_TEST",this,this.startTestHandler),this.total_time_bar=new I(this.total_time),this.total_time_bar.setTotalQuestions(t.total_q_num),this.total_time_bar.on("TIMES_UP",this,this.timesUpHandler),this.owner.addChild(this.total_time_bar),this.changeQuestion(t.curr_q_num)}changeQuestion(i){switch(this.sp_curr_question&&this.sp_curr_question.destroy(!0),i<t.total_q_num&&this.total_time_bar.setQuestionIndex(i+1),t.arr_q_data[i]["题目类型"]){case"拖动题":this.sp_curr_question=new E(Laya.stage.width,Laya.stage.height-this.total_time_bar.height);break;case"单选题":this.sp_curr_question=new q(Laya.stage.width,Laya.stage.height-this.total_time_bar.height);break;case"多选题":this.sp_curr_question=new A(Laya.stage.width,Laya.stage.height-this.total_time_bar.height)}this.sp_curr_question.on("NEXT_BTN_CLICK",this,this.nextBtnClickHandler),this.owner.addChild(this.sp_curr_question),this.sp_curr_question.drawBgColor()}showOverPage(){this.sp_curr_question&&this.sp_curr_question.destroy(!0),this.total_time_bar&&this.total_time_bar.destroy(!0),this.sp_over_page=new it,this.sp_over_page.on("RESTART_BTN_CLICK",this,this.restartBtnClickHandler),this.owner.addChild(this.sp_over_page)}nextBtnClickHandler(i){"下一题"==i?(t.curr_q_num++,this.changeQuestion(t.curr_q_num)):this.showOverPage()}restartBtnClickHandler(){t.arr_finished_data.length=0,this.sp_over_page.destroy(!0),this.startTestHandler()}timesUpHandler(){}onDisable(){}}class rt{constructor(){}static init(){(0,Laya.ClassUtils.regClass)("MainScene.ts",at)}}rt.width=768,rt.height=1200,rt.scaleMode="showall",rt.screenMode="none",rt.alignV="middle",rt.alignH="center",rt.startScene="MainScene.scene",rt.sceneRoot="",rt.debug=!1,rt.stat=!1,rt.physicsDebug=!1,rt.exportSceneToJson=!0,rt.init();new class{constructor(){Config.isAntialias=!0,window.Laya3D?Laya3D.init(rt.width,rt.height):Laya.init(rt.width,rt.height,Laya.WebGL),Laya.Physics&&Laya.Physics.enable(),Laya.DebugPanel&&Laya.DebugPanel.enable(),Laya.stage.scaleMode=rt.scaleMode,Laya.stage.screenMode=rt.screenMode,Laya.stage.alignV=rt.alignV,Laya.stage.alignH=rt.alignH,Laya.URL.exportSceneToJson=rt.exportSceneToJson,(rt.debug||"true"==Laya.Utils.getQueryString("debug"))&&Laya.enableDebugPanel(),rt.physicsDebug&&Laya.PhysicsDebugDraw&&Laya.PhysicsDebugDraw.enable(),rt.stat&&Laya.Stat.show(),Laya.alertGlobalError(!0),Laya.ResourceVersion.enable("version.json",Laya.Handler.create(this,this.onVersionLoaded),Laya.ResourceVersion.FILENAME_VERSION)}onVersionLoaded(){Laya.AtlasInfoManager.enable("fileconfig.json",Laya.Handler.create(this,this.onConfigLoaded))}onConfigLoaded(){rt.startScene&&Laya.Scene.open(rt.startScene),Laya.stage.bgColor="#307177",Laya.stage.frameRate="slow",Laya.MouseManager.multiTouchEnabled=!1}getUrlParam(t){for(var i=window.location.search.substring(1).split("&"),e=0;e<i.length;e++){var s=i[e].split("=");if(s[0]==t)return s[1]}return!1}}}();